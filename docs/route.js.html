<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>route.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="module-svelte-router.Router.html">Router</a><ul class='methods'><li data-type='method'><a href="module-svelte-router.Router.html#_resolveRedirect">_resolveRedirect</a></li><li data-type='method'><a href="module-svelte-router.Router.html#back">back</a></li><li data-type='method'><a href="module-svelte-router.Router.html#forward">forward</a></li><li data-type='method'><a href="module-svelte-router.Router.html#go">go</a></li><li data-type='method'><a href="module-svelte-router.Router.html#navigationGuard">navigationGuard</a></li><li data-type='method'><a href="module-svelte-router.Router.html#onBeforeNavigation">onBeforeNavigation</a></li><li data-type='method'><a href="module-svelte-router.Router.html#onError">onError</a></li><li data-type='method'><a href="module-svelte-router.Router.html#onNavigationChanged">onNavigationChanged</a></li><li data-type='method'><a href="module-svelte-router.Router.html#push">push</a></li><li data-type='method'><a href="module-svelte-router.Router.html#replace">replace</a></li><li data-type='method'><a href="module-svelte-router.Router.html#routeURL">routeURL</a></li><li data-type='method'><a href="module-svelte-router.Router.html#start">start</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-svelte-router.html">svelte-router</a></li><li><a href="module-svelte-router_history.html">svelte-router/history</a><ul class='methods'><li data-type='method'><a href="module-svelte-router_history.html#~history">history</a></li></ul></li><li><a href="module-svelte-router_location.html">svelte-router/location</a><ul class='methods'><li data-type='method'><a href="module-svelte-router_location.html#.createLocation">createLocation</a></li></ul></li><li><a href="module-svelte-router_route.html">svelte-router/route</a><ul class='methods'><li data-type='method'><a href="module-svelte-router_route.html#.cloneRoute">cloneRoute</a></li><li data-type='method'><a href="module-svelte-router_route.html#.createRoute">createRoute</a></li><li data-type='method'><a href="module-svelte-router_route.html#.createRouteConfig">createRouteConfig</a></li><li data-type='method'><a href="module-svelte-router_route.html#.createRouteRecord">createRouteRecord</a></li></ul></li><li><a href="module-svelte-router_utils.html">svelte-router/utils</a><ul class='methods'><li data-type='method'><a href="module-svelte-router_utils.html#.deepClone">deepClone</a></li><li data-type='method'><a href="module-svelte-router_utils.html#.fullURL">fullURL</a></li><li data-type='method'><a href="module-svelte-router_utils.html#.hasPrefix">hasPrefix</a></li><li data-type='method'><a href="module-svelte-router_utils.html#.hasSuffix">hasSuffix</a></li><li data-type='method'><a href="module-svelte-router_utils.html#.historyFullURL">historyFullURL</a></li><li data-type='method'><a href="module-svelte-router_utils.html#.joinPath">joinPath</a></li><li data-type='method'><a href="module-svelte-router_utils.html#.parseURL">parseURL</a></li><li data-type='method'><a href="module-svelte-router_utils.html#.trimPrefix">trimPrefix</a></li><li data-type='method'><a href="module-svelte-router_utils.html#.urlMatch">urlMatch</a></li><li data-type='method'><a href="module-svelte-router_utils.html#.urlPrefix">urlPrefix</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">route.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Svelte Router route module.
 * @module svelte-router/route
 */

import tc from '@spaceavocado/type-check';
import {fullURL, deepClone} from './utils';

/**
 * Route config object.
 * @typedef Config
 * @property {string} path location path use to resolve the route.
 * @property {string|object|function} redirect route redirect.
 * * string: plain URL.
 * * object: route name {name: 'ROUTE'}.
 * * function: callback function fn(to) to resolve the redirect.
 * @property {string} name name of the route.
 * @property {function} component svelte component.
 * @property {object} meta route meta object.
 * @property {boolean|object|function} props props passed to component.
 * * true: auto-resolve props from route params.
 * * object: pass this object directly to component as props.
 * * function: callback function to resolve props from route object.
 * @property {svelte-router/route~Config[]} children children routes.
 * @property {module:svelte-router/route~Config} parent parent route.
 */

/**
 * Create route config object.
 * @param {module:svelte-router/route~Config} prefab route config prefab,
 * only properties defined on svelte-router/route~Config will be used.
 * @throws Will throw an error if the route prefab config is invalid.
 * @return {module:svelte-router/route~Config}
 */
export function createRouteConfig(prefab) {
  if (tc.isNullOrUndefined(prefab) || tc.not.isObject(prefab)) {
    throw new Error('invalid route config prefab');
  }
  if (tc.isNullOrUndefined(prefab.path) || tc.not.isString(prefab.path)) {
    throw new Error('invalid route config path property');
  }
  if (tc.not.isNullOrUndefined(prefab.component)
    &amp;&amp; tc.not.isFunction(prefab.component)) {
    throw new Error('invalid route config component property');
  }
  if (prefab.meta &amp;&amp; tc.not.isObject(prefab.meta)) {
    throw new Error('invalid route config meta property');
  }

  if (tc.isNullOrUndefined(prefab.redirect)) {
    prefab.redirect = null;
  } else if (tc.not.isString(prefab.redirect)
    &amp;&amp; tc.not.isObject(prefab.redirect)
    &amp;&amp; tc.not.isFunction(prefab.redirect)) {
    throw new Error('invalid route config redirect property');
  }

  if (tc.isNullOrUndefined(prefab.props)) {
    prefab.props = false;
  } else if (prefab.props !== true
    &amp;&amp; tc.not.isObject(prefab.props)
    &amp;&amp; tc.not.isFunction(prefab.props)) {
    throw new Error('invalid route config props property');
  }

  return {
    path: prefab.path,
    redirect: prefab.redirect,
    component: prefab.component || false,
    name: prefab.name || null,
    meta: prefab.meta || {},
    props: prefab.props,
    children: prefab.children || [],
    parent: {},
  };
}

/**
 * Route record object.
 * @typedef Record
 * @property {string} path location path use to resolve the route.
 * @property {string|object|function} redirect route redirect.
 * * string: plain URL.
 * * object: route name {name: 'ROUTE'}.
 * * function: callback function fn(to) to resolve the redirect.
 * @property {string?} name name of the route.
 * @property {function} component svelte component.
 * @property {object} meta route meta.
 * @property {object} params route resolved params.
 * @property {boolean|object|function} props props passed to component.
 * * true: auto-resolve props from route params.
 * * object: pass this object directly to component as props.
 * * function: callback function to resolve props from route object.
 */

/**
 * Create route record.
 * @param {module:svelte-router/route~Config} route Matching route config.
 * @param {string[]|object} params Regex exec output or params object.
 * @return {module:svelte-router/route~Record}
 */
export function createRouteRecord(route, params) {
  const record = {
    path: route.path,
    redirect: route.redirect,
    name: route.name,
    component: route.component,
    meta: route.meta,
    props: route.props,
    params: {},
  };

  // Regex array setter
  let setParamValue = (key, collection, index) => {
    index++;
    if (index &lt; params.length) {
      collection[key] = params[index];
    }
  };

  // Object setter
  if (tc.isObject(params)) {
    setParamValue = (key, collection, index) => {
      if (tc.not.isNullOrUndefined(params[key])) {
        collection[key] = params[key];
      }
    };
  }

  // Params
  for (let i = 0; i &lt; route.paramKeys.length; i++) {
    setParamValue(route.paramKeys[i].name, record.params, i);
  }

  return record;
}

/**
 * Route object.
 * @typedef Route
 * @property {string} name name of the route.
 * @property {string} path location path use to resolve the route.
 * @property {string|object|function} redirect route redirect.
 * * string: plain URL.
 * * object: route name {name: 'ROUTE'}.
 * * function: callback function fn(to) to resolve the redirect.
 * @property {string} hash url hash.
 * @property {string} fullPath the full resolved URL including query and hash.
 * @property {object} params params object used to resolve the path params.
 * @property {object} query query parameters.
 * @property {module:svelte-router/history~HISTORY_ACTION} action route action.
 * @property {module:svelte-router/route~Record[]} matched resolved
 * route records.
 */

/**
 * Create route object.
 * @param {module:svelte-router/location~Location} location triggered location.
 * @param {module:svelte-router/route~Record[]} matches collection of
 * matched route records.
 * @return {module:svelte-router/route~Route}
 */
export function createRoute(location, matches) {
  // Get the last route in the stack as the resolved route
  const route = matches[matches.length-1];
  return {
    name: route.name,
    action: location.action,
    path: location.path,
    redirect: route.redirect,
    hash: location.hash,
    fullPath: fullURL(location.path, location.query, location.hash),
    params: route.params,
    query: location.query,
    meta: route.meta,
    matched: matches,
  };
};

/**
 * Deep clone route.
 * @param {module:svelte-router/route~Route} route source route.
 * @return {module:svelte-router/route~Route}
 */
export function cloneRoute(route) {
  if (route == null) {
    return {};
  }
  const clone = deepClone(route);
  clone.redirect = route.redirect;
  for (let i = 0; i &lt; route.matched.length; i++) {
    clone.matched[i].component = route.matched[i].component;
    clone.matched[i].props = route.matched[i].props;
    clone.matched[i].meta = route.matched[i].meta;
    clone.matched[i].redirect = route.matched[i].redirect;
  }
  return clone;
}
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Thu Aug 15 2019 13:35:39 GMT-0400 (Eastern Daylight Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
